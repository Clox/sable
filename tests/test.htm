<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/cleave.js/1.0.2/cleave.min.js" integrity="sha512-SvgzybymTn9KvnNGu0HxXiGoNeOi0TTK7viiG0EGn2Qbeu/NFi3JdWrJs2JHiGA1Lph+dxiDv5F9gDlcgBzjfA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="../src/tablance.js"></script>
	<link rel="stylesheet" href="../styles/style.min.css">

	<script src="https://cdn.jsdelivr.net/npm/pikaday/pikaday.js"></script>
	<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/pikaday/css/pikaday.css">

	<script>
		document.addEventListener("DOMContentLoaded", ()=>{
			function descFunc(dataRow,col,rowIndex,colIndex) {
				return `foobar ${rowIndex} - ${dataRow.descLetter}`
			}
			const myTablanceCols=[{type:"expand"}
				,{id:"desc",title:"Description",edit:{onChange:(...args)=>console.log(args),
					dataType:"text",maxLength:5,placeholder:"placeholder",enabled:()=>Math.random()>.5},render:descFunc}
				,{id:"amount",title:"Amount",width:"70px"},{id:"balance",title:"Balance",width:"70px"}];
			
			const foods=[{text:"banana",value:1},{text:"apple",value:2},{text:"cucumber",value:3},
						{text:"orange",value:4},{text:"grapes",value:5},{text:"melon",value:6},
						{text:"pineapple",value:7},{text:"carrot",value:8}];
			const myExpansion={type:"list",titlesColWidth:"8em",entries:[
				{type:"field",title:"Select",id:"sel",edit:{dataType:"select"
						,options:foods,minOptsFilter:1000,allowSelectEmpty:true}},
				{type:"field",title:"Date",id:"date",edit:{dataType:"date",onChange:(...args)=>console.log(args)}},
				{type:"repeated",id:"repeatedField",entry:
					{type:"field",title:"repeated row",id:"foo"}
				},
				{type:"field",edit:{dataType:"button",btnText:"Cool button",clickHandler:btnClickHandler}},
				{type:"group",title:"förordnande",entries:[
					{type:"repeated",id:"custodianshipChanges",create:true,onCreate:(...args)=>console.log(args)
					,creationText:"Lägg till",deleteAreYouSureText:"Är du säker?",deleteText:"Ta bort"
					,areYouSureYesText:"Ja",areYouSureNoText:"Nej",entry:
						{type:"group",closedRender:data=>`${data.type} sedan ${data.date}`,entries:[
								{type:"field",title:"Datum",id:"date",edit:{dataType:"date"}},
								{type:"field",title:"Typ av ställföreträdarskap",id:"type",edit:{dataType:"select",
									options:[{text:"God Man",value:"trustee"},{text:"Förvaltare",value:"administrator"}]
									,allowSelectEmpty:false
								}}
						]}
					}
				]},
				{type:"collection",title:"Bunch ",entries:[
					{type:"field",title:"First thing",id:"first"},
					{type:"field",title:"Second thing",id:"second"},
					{type:"field",title:"Third thing",id:"third"},
					{type:"field",edit:{dataType:"button",btnText:"My button"}},
					{type:"field",title:"Fourth thing",id:"fourth"},
					{type:"field",title:"Fifth thing",id:"fifth"},
					{type:"field",title:"Sixth thing",id:"sixth"},
					{type:"field",title:"Seventh thing",id:"seventh"},
				]},
				{type:"group",title:"grupp",entries:[
					{type:"field",title:"Hello",id:"hello",edit:{dataType:"text"}},
					{type:"field",title:"World",id:"world",edit:{dataType:"text"}},
					{type:"field",title:"Emptytest",id:"emptykey",edit:{dataType:"text"}}]},
				{type:"field",title:"Foobar One",id:"foobar1",edit:{dataType:"text",maxLength:5,placeholder:"boo"}},
				{type:"field",title:"Foobar Two",id:"foobar2"},
				{type:"list",title:"Baz entries",titlesColWidth:"6em",entries:[
					{type:"field",title:"Baz One",id:"baz1"},
					{type:"field",title:"Baz Two",id:"baz2"},
					{type:"field",title:"Cleave-datum",id:"cleaveDate",
						edit:{cleave:{date: true,delimiter: '-',datePattern: ['Y','m','d']},placeholder:"ÅÅÅÅ-MM-DD"}},
					{type:"field",title:"Anteckningar",id:"notes",maxHeight:150,edit:{dataType:"textarea"}},
				]},
			]};
			



			const myTablance=new Tablance(document.getElementById("tablanceContainer1"),myTablanceCols,true,true
				,myExpansion,{defaultDatePlaceholder:"ÅÅÅÅ-MM-DD",defaultSelectNoResultText:"Inga resultat"});

			
			for (let i=0; i<3; i++) {
				let data=[];
				for (let ii=0; ii<1000; ii++) {
					data.push({desc:"dummy",foobar1:i+ii,foobar2:i*2+ii*2,descLetter:String.fromCharCode(ii)
						,amount:(Math.random()*100).toFixed(2),balance:(Math.random()*100).toFixed(2),baz1:69,baz2:70
						,hello:"Hallå",world:"Världen"
						,sel:null//Math.round(Math.random()*(foods.length-1))+1
						,repeatedField:[{foo:"row one in repeated"},{foo:"row two in repeated"}]
						,repeatedGroup:[{foo1:"blahblah",foo2:"lalala"},{foo1:"bloj",foo2:"kapapa"}]
						,custodianshipChanges:[
										{date:"2021-01-01",type:"trustee"},{date:"2022-01-01",type:"administrator"}],
						first:"One",second:"Second",third:"Third",fourth:"Fourth",fifth:"Five",sixth:"Sixth"
						,seventh:"Seven"});
				}
				myTablance.addData(data);
			}
		});
		function btnClickHandler(e,dataObject,mainIndex,struct,cellObject) {
			console.log(e);
			console.log(dataObject);
			console.log(mainIndex);
			console.log(struct);
			console.log(cellObject);
		}
	</script>
</head>

<body>
	<input value="input for testing tab-focusing"/>
	<div id="tablanceContainer1" style="overflow:hidden;resize: both;height:700px;width:700px"></div>
	<br />
	<div id="tablanceContainer2" style="overflow:hidden; resize: both;"></div>
</body>